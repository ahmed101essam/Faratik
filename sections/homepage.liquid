<div>
  <div
    class="hero bg-cover bg-center bg-no-repeat min-h-screen border-b-12 border-white relative"
    style="
      {% if section.settings.mobile_hero %}
        background-image: url('{{ section.settings.mobile_hero | image_url: width: 800 }}');
      {% endif %}
    "
  >
    <a
      href="{{routes.all_products_collection_url }}"
      class="absolute bottom-3 left-1/2 -translate-x-1/2 bg-[#f2bb06] text-2xl text-center text-nowrap btn-cartoon-orange md:text-4xl font-['Bangers'] px-3 py-2 md:px-4 md:py-4 inline-block hover:scale-105 transition-transform"
    >
      Explore collection!
    </a>
  </div>

  <div class="max-w-6xl mx-auto my-6 px-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
    <!-- Free Shipping Card -->
    <div class="px-4 py-6 btn-cartoon bg-[#ff7e06] font-[bangers] shadow-lg text-xl md:text-3xl outlined-text text-black font-bold flex items-center justify-center text-center">
      Free Shipping for Orders above {{ 30000 | money }} Inside Big Cairo
    </div>

    <!-- Contact Card -->
    <div class="px-4 py-6 btn-cartoon bg-[#f2bb06] font-[bangers] shadow-lg text-xl md:text-3xl outlined-text text-black font-bold flex flex-col items-center justify-center text-center">
      <p>Big Deals and Office Celebrations Just Contact Us</p>
      <a
        href="{{ routes.root_url }}pages/contact"
        class="cursor-pointer text-white btn-cartoon px-4 py-2 bg-[#cd0102] hover:bg-[#ab0101] transition-colors rounded inline-block"
      >
        Contact Us Now
      </a>
    </div>

    <!-- Image Card -->
    <div class="card-image btn-cartoon bg-[#f2bb06] font-[bangers] shadow-lg text-xl md:text-3xl outlined-text text-black font-bold flex flex-col items-center justify-center text-center">
      {% if section.settings.card_image %}
        <img
          width=""
          height=""
          src="{{ section.settings.card_image | image_url: width: 600 }}"
          alt="{{ section.settings.card_image_alt | default: 'Featured product' }}"
          loading="lazy"
          class="w-full h-full object-cover object-center max-h-[200px]"
        >
      {% else %}
        <div class="w-full h-full min-h-[200px] bg-gray-200 flex items-center justify-center text-gray-500">
          No image selected
        </div>
      {% endif %}
    </div>
  </div>

  <!-- Products Swiper Section -->
  <div class="max-w-6xl mx-auto my-12 px-4">
    <div class="flex justify-between items-center mb-6">
      <h2 class="text-3xl md:text-4xl font-['Bangers'] text-black">
        {{ section.settings.swiper_title | default: 'New Arrivals' }}
      </h2>
    </div>

    <!-- Swiper Container -->
    <div class="swiper product-swiper rounded-lg shadow-lg p-4">
      <div class="swiper-wrapper h-80">
        {% if section.settings.product_collection != blank %}
          {% assign collection = collections[section.settings.product_collection] %}
          {% for product in collection.products limit: 12 %}
            <div class="swiper-slide h-80">
              <div class="product-card border-3 border-black transition hover:shadow-2xl">
                <a href="{{ product.url }}">
                  <div class="w-full h-8/12 overflow-hidden">
                    {% if product.featured_image %}
                      <img
                        src="{{ product.featured_image | image_url: width: 400 }}"
                        alt="{{ product.featured_image.alt | default: product.title }}"
                        loading="lazy"
                        width=""
                        height=""
                        class="w-full h-full object-cover"
                      >
                    {% else %}
                      <div class="w-full h-full bg-gray-200 flex items-center justify-center">
                        <span class="text-gray-400">No image</span>
                      </div>
                    {% endif %}
                  </div>
                  <div class="bg-white py-2 px-3 pb-4 flex flex-col items-center w-full gap-1">
                    <h2 class="text-xl font-medium font-['Poppins'] text-center">{{ product.title }} -</h2>
                    <p class="text-center font-bold text-2xl">{{ product.price | money }}</p>
                    <button class="bg-[#cd0102] bg-no-repeat cursor-pointer bg-cover atc btn-cartoon px-3 py-1 text-center text-white font-['Bangers'] outlined-text">
                      <div>View Product</div>
                    </button>
                  </div>
                </a>
              </div>
            </div>
          {% endfor %}

          <!-- View All Slide -->
          <div class="swiper-slide h-full min-h-80">
            <a href="{{ collection.url }}" class="block h-80">
              <div class="product-card border-4 border-black rounded-lg bg-[#f2bb06] hover:bg-[#e0ab00] transition-colors h-full flex flex-col items-center justify-center p-8 ">
                <svg class="w-16 h-16 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
                </svg>
                <h3 class="font-['Bangers'] text-2xl md:text-3xl text-black text-center">View All Products</h3>
                <p class="font-['Poppins'] text-sm mt-2 text-black">Explore our full collection</p>
              </div>
            </a>
          </div>
        {% else %}
          <!-- Placeholder slides when no collection selected -->
          {% for i in (1..4) %}
            <div class="swiper-slide ">
              <div class="product-card border-2 border-black rounded-lg overflow-hidden bg-white">
                <div class="w-full h-48 bg-gray-200 flex items-center justify-center">
                  <span class="text-gray-400">Product {{ i }}</span>
                </div>
                <div class="p-4">
                  <h3 class="font-['Poppins'] font-bold text-base text-gray-400 mb-2">Sample Product</h3>
                  <span class="font-['Poppins'] font-bold text-lg text-gray-400"> LE0.00 </span>
                </div>
              </div>
            </div>
          {% endfor %}
        {% endif %}
      </div>

      <!-- Navigation Buttons -->
      <div
        class="swiper-button-next btn-cartoon bg-[#f2bb06] border-2 border-black rounded-full w-12! h-12! after:text-xl! after:font-bold!"
      ></div>
      <div
        class="swiper-button-prev btn-cartoon bg-[#f2bb06] border-2 border-black rounded-full w-12! h-12! after:text-xl! after:font-bold!"
      ></div>

      <!-- Pagination -->
      <div class="swiper-pagination bottom-0!"></div>
    </div>
  </div>
</div>

<style>
  .card {
    {% if section.settings.card_pattern %}
      background-image: url('{{ section.settings.card_pattern | image_url }}');
    {% endif %}
    background-size: contain;
    background-position: center;
    background-repeat: repeat;
  }

  /* Image card doesn't need pattern background */
  .card-image {
    background: white;
  }

  /* Desktop override */
  @media (min-width: 768px) {
    .hero {
      {% if section.settings.desk_hero %}
        background-image: url('{{ section.settings.desk_hero | image_url: width: 1920 }}') !important;
      {% endif %}
    }
  }

  /* Swiper Styles */
  .product-swiper {
    padding-bottom: 50px;
  }

  .swiper-button-next,
  .swiper-button-prev {
    color: #000;
  }

  .swiper-button-next:after,
  .swiper-button-prev:after {
    font-size: 20px;
    font-weight: bold;
  }

  .swiper-pagination-bullet {
    background: #000;
    opacity: 0.3;
  }

  .swiper-pagination-bullet-active {
    background: #cd0102;
    opacity: 1;
  }

  /* Line clamp for product titles */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>

<!-- Swiper JS -->

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const swiper = new Swiper('.product-swiper', {
      slidesPerView: 1,
      spaceBetween: 20,
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
      breakpoints: {
        640: {
          slidesPerView: 2,
          spaceBetween: 20,
        },
        768: {
          slidesPerView: 3,
          spaceBetween: 20,
        },
        1024: {
          slidesPerView: 4,
          spaceBetween: 20,
        },
      },
      loop: false,
      autoplay: {
        delay: 3000,
        disableOnInteraction: false,
      },
    });
  });
</script>

{% schema %}
{
  "name": "Home Page Schema",
  "settings": [
    {
      "type": "image_picker",
      "id": "desk_hero",
      "label": "Desktop Hero Image"
    },
    {
      "type": "image_picker",
      "id": "mobile_hero",
      "label": "Mobile Hero Image"
    },
    {
      "type": "image_picker",
      "id": "card_pattern",
      "label": "Card Background Pattern (optional)"
    },
    {
      "type": "image_picker",
      "id": "card_image",
      "label": "Image for the third card"
    },
    {
      "type": "text",
      "id": "card_image_alt",
      "label": "Third card image alt text",
      "default": "Featured product"
    },
    {
      "type": "text",
      "id": "swiper_title",
      "label": "Products Section Title",
      "default": "New Arrivals"
    },
    {
      "type": "collection",
      "id": "product_collection",
      "label": "Product Collection"
    }
  ],
  "presets": [
    {
      "name": "Hero Section"
    }
  ]
}
{% endschema %}
